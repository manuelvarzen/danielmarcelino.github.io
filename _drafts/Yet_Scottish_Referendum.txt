 <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
Hello, Daniel. I was very interested in your post `Bayes says "don't worry"...' and thought I would study the
Scotland2.R
lines of R code that you kindly provide.
As far as I can see, you are working out, by simulation
Pr(U_1 < U_2 | data), where
(U_1, U_2, U_3) have joint distribution which is Dirichlet, let's say D(a_1,a_2,a_3).
But a little bit of maths shows you that we can work this out directly from the beta distribution, since
(U_1/(U_1 + U_2)) has beta distribution, parameters (a_1,a_2)
so you only need to look up, from R
Pr(U_1/(U_1 + U_2) < 1/2 |data)
No need for recourse to any simulation. 
I would be interested to hear your views
Happily, we now know the outcome of the referendum!
Best wishes.......... Patricia Altham
http://www.statslab.cam.ac.uk/~pat

Prof. Altham was certainly right that the simulation procedure could be safely discarded. The following is the proof:
```` 
// R> wtd.polls
//             Yes     No    n Others
// Opinium   0.4300 0.4700 1156 0.1000
// Survation 0.4400 0.4800 1000 0.0800
// ICM       0.4100 0.4500 1175 0.1400
// 4         0.4259 0.4659 3331 0.1081
// 5         0.4776 0.5224 3331 0.0000
// R> 0.4776/(0.4776+0.5224)
// [1] 0.4776
// R> 0.4776/(0.4776+0.5224) <1/2
[1] TRUE
````

His message and also from the others, motivate me to "try" out demonstrating how we could obtain posterior probability distributions solving analytically rather than simulating a bunch of random values. Though I still favor the later.  

To illustrate this, I'll consider a poll published by *Survation* on 17th September among 1,000 voters (second row in the table above). This poll gave NO movement 48% of vote intentions.  Knowing that the NO side received 55% of the actual vote, I want to know what is the probability that NO support was bellow 50% P(NO < .5). In order to answer this, I will apply Bayes theorem to obtain a posterior distribution for NO. 
From equation  $$f(\theta|data) \propto f(data|\theta)  f(\theta)$$  we can see that f(poll|NO) and f(NO)  need to be specified. 
 Very simple, we can think on the f(poll|NO) component as a binomial distribution with 480 "success" and 1,000-480 "failures". Then,
 
 $$f(poll|NO) = (\frac{1000}{480}) NO^{480} (1 - NO)^{520}  \propto  NO^{480} (1 - NO)^{520}$$
  
  To complete, the Bayesian model, we specify the prior distribution f(NO).  Since a referendum is about proportions of citizens supporting one choice versus the others, it is natural to choose a distribution that is only defined on the interval [0,1]. The Beta distribution is such a distribution. Then we have that:
  
 $$f(NO|\alpha, \beta) \propto NO^{\alpha - 1}(1 - NO)^{\beta - 1}$$

The hardest part is the specification of the shape parameters \\((\alpha, \beta)\\). In R these are often identified as shape1 and shape2. A very good description can be found in Wikipedia, but the reason behind them is that  \\(\alpha\\) means   while \\(\beta\\) means the rate. 
 \\(\alpha\\) and \\(\beta\\) can be set to reflect the number of "observations" I've made. For simplicity, I'll determine the values of \\(\alpha\\) and \\(\beta\\) as if I had made actual observations sampling 1,000 respondents obtaining a proportion of NO = .55 (equal to the referendum result.)  With Binomial likelihood and a Beta prior set, it is a matter of adding the exponents together to obtain the posterior.

 
$$f(NO|poll) \propto NO^{522} (1 − NO)^{488} NO^{554} (1 − NO)^{521} = NO^{862} (1 − NO)^{1136}$$

Which is a Beta distribution with  \\(\alpha\\) = , and \\(\beta\\) = . The expectation of the beta distribution is E(X) = \\(\frac{\alpha}{\alpha + \beta}\\), so the posterior estimate of the NO movement support is  \\(\frac{\alpha}{\alpha + \beta}\\) = . With the posterior one calculate the probability that NO is less than or equal to 50% for example.


$$\pi(NO \le .5) = \frac{\Gamma(863 + 1137)}{\Gamma(863) \Gamma(1137)} \int_0^{.5} NO^{862} (1 - NO)^{1136} d(NO) = 0.00211$$


With this, we can see that given this poll, it was very unlikely that the NO movement  could receive less than 50% of the votes. If you follow this procedure applying for the aggregate version of the polls I provided, you'll find even higher probability for the NO side.

[@Acemoglu2005, p.65]

