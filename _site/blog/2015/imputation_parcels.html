<!DOCTYPE html>
<html lang="en">

<link rel="shortcut icon" href="/img/icon.ico" type="image/x-icon" />

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Blog of Daniel Marcelino">

    <title>Imputing scales using parcels of items as auxiliary variables - EnfoRced Data Analysis</title>

    <link rel="canonical" href="http://danielmarcelino.github.io/blog/2015/imputation_parcels.html">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/clean-blog.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="/css/syntax.css">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <link type="application/atom+xml" rel="alternate" href="http://danielmarcelino.github.io/feed.xml" title="EnfoRced Data Analysis" />

</head>


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-34554402-2', 'sdaza.com');
  ga('send', 'pageview');

</script>

<body>

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <!-- <a class="navbar-brand" href="/">EnfoRced Data Analysis</a> -->
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="/">Home</a>
                </li>
                  <li>
                    <a href="/docs/cv_sdaza.pdf">CV</a>
                </li>
                
				

                <li>
                    <a href="/01research">Research</a>
                </li>
				
                
				

                <li>
                    <a href="/02archive">Posts</a>
                </li>
				
                
				

                <li>
                    <a href="/03about">About</a>
                </li>
				
                
				

                <li>
                    <a href="/04contact">Contact</a>
                </li>
				
                
				

                <li>
                    <a href="/thanks">Contact</a>
                </li>
				
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>


    <script language="javascript">
    function typeset() {
        MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
    }

    function disqus_config() {
        this.callbacks.onNewComment = [typeset];
        this.callbacks.onInit = [typeset];
    }


    if(window.MathJax===undefined){
        var script = document.createElement("script");
        script.type = "text/javascript";
        script.src  = "http://cdn.mathjax.org/mathjax/latest/MathJax.js";
        var config = 'MathJax.Hub.Config({' +
                    'extensions: ["tex2jax.js"],' +
                    'tex2jax: { inlineMath: [ ["$","$"]], displayMath: [["\$$","\$$"]], processEscapes: true },' +
                    'jax: ["input/TeX","output/HTML-CSS"]' +
                    '});' +
                    'MathJax.Hub.Startup.onload();';
        if (window.opera)
            script.innerHTML = config;
        else
            script.text = config;
        document.getElementsByTagName("head")[0].appendChild(script);
    }
</script>

<!-- Post Header -->
<header class="intro-header" style="background-image: url('/img/demography.jpg')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>Imputing scales using parcels of items as auxiliary variables</h1>
                    
                    <span class="meta">Posted by EnfoRced Data Analysis on October 14, 2015</span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">

				<p><strong>Last Update: 02/07/2016</strong></p>

<p>Multiple imputation. Ugh. Multiple imputation of scales using several items. Ugh squared! Fortunately, to impute every single item is not the only solution. There are some practical and <em>theoretically</em> attractive alternatives! In this post, I show a simple implementation of what Enders (2010) calls <strong>duplicated-scale imputation</strong>. The specific method I show here was proposed by Eekhout et al. (2011). Thanks <a href="http://www.iriseekhout.com">Iris Eekhout</a> for replying my emails and answering my questions!</p>

<h2 id="procedure">Procedure</h2>

<p>For each scale, I define a number (or proportion) of items (let’s say <strong>p</strong>) to create parcels (i.e., average of items). These parcels are used as auxiliary variables to impute the original scales. There are different ways to define parcels. I implemented a solution: see the function <em>rowscore</em> available in my R package <a href="http://github.com/sdaza/sdazar">sdazar</a>.</p>

<p>The function <code class="highlighter-rouge">rowscore</code> select <strong>p</strong> items with less missing data. For each case (row), it computes the parcels using the available information of the selected items. If only one item has information, only that one will be used. If there are more than one item with valid data, it will average the available items. If there are no items available, it will pick <strong>p</strong> items from the rest of items to impute the original scale. In this particular example I created parcels using half of the items:</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">rowscore</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">items</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="m">1</span><span class="o">/</span><span class="m">2</span><span class="p">,</span> <span class="n">type</span> <span class="o">=</span> <span class="s2">"parcel"</span><span class="p">)</span></code></pre></figure>

<p>The idea of using a proportion of the original items is to include as much as information possible but preventing strong linear dependencies between the variables. Ideally, after this procedure, <em>parcels</em> should be complete. However, because in some cases all the items are missing, parcels can still have missing records (although less than the original scales).</p>

<p><strong>Why not just to use the average of the available items?</strong> That solution would implicitly assume that items perfectly correlates with the scale. We know that is not a good assumption. That is why, after all, we worry about creating scales. Using parcels takes advantage of the available information (items with complete information) and the relationship between a portion of items and the scale.</p>

<p>Here I show a simple example using the <a href="http://www.cpc.unc.edu/projects/addhealth">National Longitudinal Study of Adolescent to Adult Health (Add Health)</a>. First, let’s look some descriptives of the variables included in the imputation. I am using information from Wave 1 and 2. The key scales/scores are depression (19 items) and GPA (4 items). Variables ending with  <code class="highlighter-rouge">.p</code> are parcels with 1/2 of the items of the original scale.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">dim</span><span class="p">(</span><span class="n">dats</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">## [1] 12976    15</code></pre></figure>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">str</span><span class="p">(</span><span class="n">dats</span><span class="p">[,</span> <span class="n">nvars</span><span class="p">,</span> <span class="n">with</span> <span class="o">=</span> <span class="n">FALSE</span><span class="p">])</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">## Classes 'data.table' and 'data.frame':	12976 obs. of  15 variables:
##  $ female   : Factor w/ 2 levels "0","1": 1 1 1 2 1 1 1 1 1 1 ...
##  $ age      : int  16 16 14 13 14 17 14 17 17 14 ...
##  $ race     : Factor w/ 5 levels "white","black",..: 2 1 1 1 2 1 3 3 3 2 ...
##  $ class    : Factor w/ 4 levels "1","2","3","4": 1 2 2 4 1 4 3 4 2 3 ...
##  $ publicass: Factor w/ 2 levels "0","1": 1 1 1 1 1 1 1 1 1 NA ...
##  $ bmi      : num  27.4 16.3 22.2 18.2 21.9 ...
##  $ gpa1     : num  2 3.25 3.75 3.25 2.25 1 NA 2.25 NA 2.5 ...
##  $ gpa2     : num  2.5 2.5 4 3.75 1.75 1.5 NA 3 1 4 ...
##  $ gpa1.p   : num  2.5 3.5 3.5 3 2.5 1 3.5 3 1 3.5 ...
##  $ gpa2.p   : num  2.5 2.5 4 3.5 1.5 2 1.5 3 1 4 ...
##  $ dep1.p   : num  0.2 0.7 0 0.3 0.4 0.4 0.1 1 0.6 1.2 ...
##  $ dep1     : num  0.263 0.789 0 0.211 0.474 ...
##  $ dep2.p   : num  0.6 0.6 0.1 0.3 0.4 0.6 0.2 1.1 0.8 0.5 ...
##  $ dep2     : num  0.6316 0.5263 0.0526 0.1579 0.3684 ...
##  $ ppvt     : int  101 75 121 96 79 97 103 89 82 120 ...
##  - attr(*, ".internal.selfref")=&lt;externalptr&gt;</code></pre></figure>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># create summary table using package tables
</span><span class="n">missing</span> <span class="o">&lt;-</span> <span class="k">function</span> <span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="p">{</span><span class="n">sum</span><span class="p">(</span><span class="n">is.na</span><span class="p">(</span><span class="n">x</span><span class="p">))}</span>
<span class="n">tabular</span><span class="p">(</span>
  <span class="p">(</span> <span class="n">dep2</span> <span class="o">+</span> <span class="n">dep2.p</span> <span class="o">+</span> <span class="n">dep1</span> <span class="o">+</span> <span class="n">dep1.p</span> <span class="o">+</span> <span class="n">gpa2</span> <span class="o">+</span> <span class="n">gpa2.p</span> <span class="o">+</span>
    <span class="n">gpa1</span> <span class="o">+</span> <span class="n">gpa1.p</span>  <span class="o">+</span> <span class="n">age</span> <span class="o">+</span> <span class="n">bmi</span> <span class="o">+</span> <span class="n">ppvt</span> <span class="p">)</span>
   <span class="o">~</span>  <span class="p">(</span><span class="n">Format</span><span class="p">(</span><span class="n">digit</span> <span class="o">=</span> <span class="m">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span> <span class="n">Heading</span><span class="p">(</span><span class="s2">"Mean"</span><span class="p">)</span>
   	<span class="o">*</span> <span class="n">sdazar</span><span class="o">::</span><span class="n">Mean</span> <span class="o">+</span> <span class="n">Heading</span><span class="p">(</span><span class="s2">"SD"</span><span class="p">)</span>
   	<span class="o">*</span> <span class="n">sdazar</span><span class="o">::</span><span class="n">Sd</span> <span class="o">+</span> <span class="n">Heading</span><span class="p">(</span><span class="s2">"Min"</span><span class="p">)</span>
   	<span class="o">*</span> <span class="n">sdazar</span><span class="o">::</span><span class="n">Min</span> <span class="o">+</span> <span class="n">Heading</span><span class="p">(</span><span class="s2">"Max"</span><span class="p">)</span>
   	<span class="o">*</span> <span class="n">sdazar</span><span class="o">::</span><span class="n">Max</span> <span class="o">+</span> <span class="p">(</span><span class="n">Heading</span><span class="p">(</span><span class="s2">"Missing"</span><span class="p">)</span> <span class="o">*</span> <span class="n">missing</span> <span class="p">))),</span>
  <span class="n">data</span> <span class="o">=</span> <span class="n">dats</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">##                                                
##         Mean    SD      Min     Max     Missing
##  dep2      0.58    0.39    0.00    2.95   68.00
##  dep2.p    0.58    0.43    0.00    3.00    6.00
##  dep1      0.58    0.39    0.00    2.84   81.00
##  dep1.p    0.62    0.44    0.00    3.00   18.00
##  gpa2      2.86    0.74    1.00    4.00 4710.00
##  gpa2.p    2.76    0.84    1.00    4.00 1238.00
##  gpa1      2.82    0.76    1.00    4.00 2788.00
##  gpa1.p    2.74    0.85    1.00    4.00  342.00
##  age      15.28    1.61   11.00   21.00    9.00
##  bmi      22.37    4.42   11.47   63.47  353.00
##  ppvt    100.17   15.00   13.00  146.00  568.00</code></pre></figure>

<p>As expected, the correlation between the scales and parcels is high. GPA variables have most of the problems. Note that parcels <code class="highlighter-rouge">.p</code> still have missing records, although much less than the original scales.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">cor</span><span class="p">(</span><span class="n">dats</span><span class="p">[,</span> <span class="err">.</span><span class="p">(</span><span class="n">dep1</span><span class="p">,</span> <span class="n">dep1.p</span><span class="p">)],</span> <span class="n">use</span> <span class="o">=</span> <span class="s2">"complete"</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">##         dep1 dep1.p
## dep1   1.000  0.947
## dep1.p 0.947  1.000</code></pre></figure>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">cor</span><span class="p">(</span><span class="n">dats</span><span class="p">[,</span> <span class="err">.</span><span class="p">(</span><span class="n">dep2</span><span class="p">,</span> <span class="n">dep2.p</span><span class="p">)],</span> <span class="n">use</span> <span class="o">=</span> <span class="s2">"complete"</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">##         dep2 dep2.p
## dep2   1.000  0.948
## dep2.p 0.948  1.000</code></pre></figure>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">cor</span><span class="p">(</span><span class="n">dats</span><span class="p">[,</span> <span class="err">.</span><span class="p">(</span><span class="n">gpa1</span><span class="p">,</span> <span class="n">gpa1.p</span><span class="p">)],</span> <span class="n">use</span> <span class="o">=</span> <span class="s2">"complete"</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">##         gpa1 gpa1.p
## gpa1   1.000  0.888
## gpa1.p 0.888  1.000</code></pre></figure>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">cor</span><span class="p">(</span><span class="n">dats</span><span class="p">[,</span> <span class="err">.</span><span class="p">(</span><span class="n">gpa2</span><span class="p">,</span> <span class="n">gpa2.p</span><span class="p">)],</span> <span class="n">use</span> <span class="o">=</span> <span class="s2">"complete"</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">##         gpa2 gpa2.p
## gpa2   1.000  0.885
## gpa2.p 0.885  1.000</code></pre></figure>

<p>I use the R package <em>MICE</em> to impute the data.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">ini</span> <span class="o">&lt;-</span> <span class="n">mice</span><span class="p">(</span><span class="n">dats</span><span class="p">[,</span> <span class="n">nvars</span><span class="p">,</span> <span class="n">with</span> <span class="o">=</span> <span class="n">FALSE</span><span class="p">],</span> <span class="n">m</span> <span class="o">=</span> <span class="m">1</span><span class="p">,</span> <span class="n">maxit</span> <span class="o">=</span> <span class="m">0</span><span class="p">)</span>

<span class="c1"># get methods
</span><span class="p">(</span><span class="n">meth</span> <span class="o">&lt;-</span> <span class="n">ini</span><span class="o">$</span><span class="n">meth</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">##    female       age      race     class publicass       bmi      gpa1      gpa2    gpa1.p    gpa2.p    dep1.p      dep1    dep2.p      dep2      ppvt 
##        ""     "pmm"        "" "polyreg"  "logreg"     "pmm"     "pmm"     "pmm"     "pmm"     "pmm"     "pmm"     "pmm"     "pmm"     "pmm"     "pmm"</code></pre></figure>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># get predictor matrix
</span><span class="n">pred</span> <span class="o">&lt;-</span> <span class="n">ini</span><span class="o">$</span><span class="n">pred</span></code></pre></figure>

<p>I adjusted the predictor matrix to avoid feedbacks during the imputation (circularity between variables). The main adjustment is to use only complete variables when imputing <em>parcels</em>.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># predict parcels only with complete variables to avoid feedbacks
</span><span class="n">pred</span><span class="p">[</span><span class="s2">"gpa1.p"</span><span class="p">,</span> <span class="p">]</span> <span class="o">&lt;-</span> <span class="m">0</span>
<span class="n">pred</span><span class="p">[</span><span class="s2">"gpa2.p"</span><span class="p">,</span> <span class="p">]</span> <span class="o">&lt;-</span> <span class="m">0</span>
<span class="n">pred</span><span class="p">[</span><span class="s2">"dep1.p"</span><span class="p">,</span> <span class="p">]</span> <span class="o">&lt;-</span> <span class="m">0</span>
<span class="n">pred</span><span class="p">[</span><span class="s2">"dep2.p"</span><span class="p">,</span> <span class="p">]</span> <span class="o">&lt;-</span> <span class="m">0</span>

<span class="n">pred</span><span class="p">[</span><span class="s2">"gpa1.p"</span><span class="p">,</span> <span class="n">c</span><span class="p">(</span><span class="s2">"female"</span><span class="p">,</span> <span class="s2">"race"</span><span class="p">)]</span> <span class="o">&lt;-</span> <span class="m">1</span>
<span class="n">pred</span><span class="p">[</span><span class="s2">"gpa2.p"</span><span class="p">,</span> <span class="n">c</span><span class="p">(</span><span class="s2">"female"</span><span class="p">,</span> <span class="s2">"race"</span><span class="p">)]</span> <span class="o">&lt;-</span> <span class="m">1</span>
<span class="n">pred</span><span class="p">[</span><span class="s2">"dep1.p"</span><span class="p">,</span> <span class="n">c</span><span class="p">(</span><span class="s2">"female"</span><span class="p">,</span> <span class="s2">"race"</span><span class="p">)]</span> <span class="o">&lt;-</span> <span class="m">1</span>
<span class="n">pred</span><span class="p">[</span><span class="s2">"dep2.p"</span><span class="p">,</span> <span class="n">c</span><span class="p">(</span><span class="s2">"female"</span><span class="p">,</span> <span class="s2">"race"</span><span class="p">)]</span> <span class="o">&lt;-</span> <span class="m">1</span>

<span class="c1"># predict scales using parcels
</span><span class="n">pred</span><span class="p">[,</span> <span class="s2">"gpa1.p"</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="m">0</span>
<span class="n">pred</span><span class="p">[,</span> <span class="s2">"gpa2.p"</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="m">0</span>
<span class="n">pred</span><span class="p">[,</span> <span class="s2">"dep1.p"</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="m">0</span>
<span class="n">pred</span><span class="p">[,</span> <span class="s2">"dep2.p"</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="m">0</span>

<span class="n">pred</span><span class="p">[</span><span class="s2">"gpa1"</span><span class="p">,</span> <span class="n">c</span><span class="p">(</span><span class="s2">"gpa1.p"</span><span class="p">)]</span> <span class="o">&lt;-</span> <span class="m">1</span>
<span class="n">pred</span><span class="p">[</span><span class="s2">"gpa2"</span><span class="p">,</span> <span class="n">c</span><span class="p">(</span><span class="s2">"gpa2.p"</span><span class="p">)]</span> <span class="o">&lt;-</span> <span class="m">1</span>
<span class="n">pred</span><span class="p">[</span><span class="s2">"dep1"</span><span class="p">,</span> <span class="n">c</span><span class="p">(</span><span class="s2">"dep1.p"</span><span class="p">)]</span> <span class="o">&lt;-</span> <span class="m">1</span>
<span class="n">pred</span><span class="p">[</span><span class="s2">"dep2"</span><span class="p">,</span> <span class="n">c</span><span class="p">(</span><span class="s2">"dep2.p"</span><span class="p">)]</span> <span class="o">&lt;-</span> <span class="m">1</span></code></pre></figure>

<p>Here the adjusted predictor matrix:</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">##           female age race class publicass bmi gpa1 gpa2 gpa1.p gpa2.p dep1.p dep1 dep2.p dep2 ppvt
## female         0   0    0     0         0   0    0    0      0      0      0    0      0    0    0
## age            1   0    1     1         1   1    1    1      0      0      0    1      0    1    1
## race           0   0    0     0         0   0    0    0      0      0      0    0      0    0    0
## class          1   1    1     0         1   1    1    1      0      0      0    1      0    1    1
## publicass      1   1    1     1         0   1    1    1      0      0      0    1      0    1    1
## bmi            1   1    1     1         1   0    1    1      0      0      0    1      0    1    1
## gpa1           1   1    1     1         1   1    0    1      1      0      0    1      0    1    1
## gpa2           1   1    1     1         1   1    1    0      0      1      0    1      0    1    1
## gpa1.p         1   0    1     0         0   0    0    0      0      0      0    0      0    0    0
## gpa2.p         1   0    1     0         0   0    0    0      0      0      0    0      0    0    0
## dep1.p         1   0    1     0         0   0    0    0      0      0      0    0      0    0    0
## dep1           1   1    1     1         1   1    1    1      0      0      1    0      0    1    1
## dep2.p         1   0    1     0         0   0    0    0      0      0      0    0      0    0    0
## dep2           1   1    1     1         1   1    1    1      0      0      0    1      1    0    1
## ppvt           1   1    1     1         1   1    1    1      0      0      0    1      0    1    0</code></pre></figure>

<p>Let’s impute the data!</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">imp</span> <span class="o">&lt;-</span> <span class="n">mice</span><span class="p">(</span><span class="n">dats</span><span class="p">[,</span> <span class="n">nvars</span><span class="p">,</span> <span class="n">with</span> <span class="o">=</span> <span class="n">FALSE</span><span class="p">],</span>
	<span class="n">pred</span> <span class="o">=</span> <span class="n">pred</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="m">5</span><span class="p">,</span> <span class="n">maxit</span> <span class="o">=</span> <span class="m">10</span><span class="p">)</span></code></pre></figure>

<p>Some plots to explore how the imputation went.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">plot</span><span class="p">(</span><span class="n">imp</span><span class="p">,</span> <span class="n">c</span><span class="p">(</span><span class="s2">"gpa1"</span><span class="p">,</span> <span class="s2">"gpa2"</span><span class="p">,</span> <span class="s2">"dep1"</span><span class="p">,</span> <span class="s2">"dep2"</span><span class="p">))</span></code></pre></figure>

<p><img src="/img/2015-10-14-imputation_parcels/unnamed-chunk-12-1.png" alt="center" /><img src="/img/2015-10-14-imputation_parcels/unnamed-chunk-12-2.png" alt="center" /></p>

<p>I don’t see any problematic pattern. It looks as I got a proper solution. The distribution of the variables also looks right.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">densityplot</span><span class="p">(</span><span class="n">imp</span><span class="p">,</span> <span class="o">~</span> <span class="n">gpa1</span> <span class="o">+</span> <span class="n">gpa2</span> <span class="o">+</span> <span class="n">dep1</span> <span class="o">+</span> <span class="n">dep2</span><span class="p">)</span></code></pre></figure>

<p><img src="/img/2015-10-14-imputation_parcels/unnamed-chunk-13-1.png" alt="center" /></p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">bwplot</span><span class="p">(</span><span class="n">imp</span><span class="p">,</span> <span class="n">gpa1</span> <span class="o">+</span> <span class="n">gpa2</span> <span class="o">+</span> <span class="n">dep1</span> <span class="o">+</span> <span class="n">dep2</span>  <span class="o">~</span> <span class="n">.imp</span><span class="p">)</span></code></pre></figure>

<p><img src="/img/2015-10-14-imputation_parcels/unnamed-chunk-13-2.png" alt="center" /></p>

<hr />

<h3 id="references">References</h3>

<p>Enders, Craig K. 2010. <em>Applied Missing Data Analysis</em>. The Guilford Press.</p>

<p>Eekhout, Iris, Craig K. Enders, Jos W. R. Twisk, Michiel R. de Boer, Henrica
C. W. de Vet, and Martijn W. Heymans. 2015. “Analyzing Incomplete Item Scores
in Longitudinal Data by Including Item Score Information as Auxiliary
Variables.” <em>Structural Equation Modeling: A Multidisciplinary Journal</em> 22
(4):588-602.</p>



                <hr>

                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/blog/2015/sampler.html" data-toggle="tooltip" data-placement="top" title="Simple R package to define sample sizes and MOEs">&larr; Previous Post</a>
                    </li>
                    
                    
                </ul>

            </div>
        </div>
    </div>
</article>

<hr>


    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    <li>
                        <a href="/feed.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="https://twitter.com/dmarcelinobr">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    
                    <li>
                        <a href="https://github.com/danielmarcelino">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a href="mailto:dmarcelino@live.com">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                </ul>
                <p class="copyright text-muted">Copyright &copy; Daniel Marcelino 2016</p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/clean-blog.min.js "></script>


</body>

</html>
