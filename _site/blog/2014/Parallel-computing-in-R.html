<!DOCTYPE html>
<html lang="en">

<link rel="shortcut icon" href="/img/favicon.ico" type="image/x-icon" />

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Blog of Daniel Marcelino">

    <title>Parallel computing in R - Data * Analysis + R</title>

    <link rel="canonical" href="http://danielmarcelino.github.io/blog/2014/Parallel-computing-in-R.html">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/clean-blog.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="/css/syntax.css">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <link type="application/atom+xml" rel="alternate" href="http://danielmarcelino.github.io/feed.xml" title="Data * Analysis + R" />

</head>


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-24186657-1', 'danielmarcelino.github.io');
  ga('send', 'pageview');

</script>

<body>

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <!-- <a class="navbar-brand" href="/">Data * Analysis + R</a> -->
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="/">Home</a>
                </li>
                <li>
                    <a href="/blog/">Blog</a>
                </li>
                <li>
                    <a href="/interests/">Interests</a>
                </li>
                <li>
                    <a href="/randomwalks/">Random Walks</a>
                </li>
                  <li>
                    <a href="/about/">About</a>
                </li>
		  		<li>
		  		  <a href="/" class="nav-search-link" title="Search">
		  		    <span class="fa fa-search nav-search-icon"></span>
		  		  </a>
		  		</li>
		        </ul>
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>


    <script language="javascript">
    function typeset() {
        MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
    }

    function disqus_config() {
        this.callbacks.onNewComment = [typeset];
        this.callbacks.onInit = [typeset];
    }


    if(window.MathJax===undefined){
        var script = document.createElement("script");
        script.type = "text/javascript";
        script.src  = "http://cdn.mathjax.org/mathjax/latest/MathJax.js";
        var config = 'MathJax.Hub.Config({' +
                    'extensions: ["tex2jax.js"],' +
                    'tex2jax: { inlineMath: [ ["$","$"]], displayMath: [["\$$","\$$"]], processEscapes: true },' +
                    'jax: ["input/TeX","output/HTML-CSS"]' +
                    '});' +
                    'MathJax.Hub.Startup.onload();';
        if (window.opera)
            script.innerHTML = config;
        else
            script.text = config;
        document.getElementsByTagName("head")[0].appendChild(script);
    }
</script>


<!-- Post Header -->
<header class="intro-header" style="background-image: url('/img/website/spaghetti.png')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>Parallel computing in R</h1>
                    
                    <span class="meta">Posted by Data * Analysis + R on July 1, 2014</span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">

				<p>Parallel computing is incredibly useful, but not every thing worths distribute across as many cores as possible.</p>

<p>Roughly a year ago I published an article about parallel computing in R <a href="http://danielmarcelino.com/r/05-2013/parallel-processing-when-does-it-worth/">here</a>, in which I compared computation performance among 4 packages that provide R with parallel features once R is essentially a single-thread task package.</p>

<p><img src="http://danielmarcelino.github.io/img/2014/parallel.png" alt="Experiment Result" /></p>

<p>Parallel computing is incredibly useful, but not every thing worths distribute across as many cores as possible. Actually, there are cases without enough repetitions that R will gain in performance through serial computation. That is, R takes time to distribute tasks across the processors; conversely, it will need time for binding them all together later on. Therefore, if the time for distributing and gathering pieces together is greater than the time need for single-thread computing, it doesn’t worth parallelize.</p>

<p>In this post I’ll perform the same experiment using the same physical resources, except that I will perform it in the Rstudio instead of Emacs. So I want to check whether the packages improved anything significant so far.</p>

<p>I tested a nontrivial computation instance using four critical R functions: the base <strong>lapply</strong>, <strong>mclapply</strong> from the “multicore” package, <strong>parLapply</strong> from the “snow” package, and <strong>sfLapply</strong> from the “snowfall” package. The last three functions essentially provide parallelized equivalent for the lapply.</p>

<h4 id="the-experiment">The Experiment</h4>
<p>These packages were used for distributing tasks across four CPUs of my MacBook pro with 8-G memory. The duty was to average out each column of a data frame built on the fly, but repeating this procedure 100 times for each trial because I don’t want to rely on one single round estimate. In addition, each trial demands different amount of memory allocation and time for computing once the matrix size varies as 1K, 10K, 100K, 1M, and 10M rows. The program I used to perform the tests is left <a href="https://gist.github.com/danielmarcelino/5668701">here</a>.</p>

<p>Overall, every function is doing a better job now than one year ago, but the <strong>mclapply</strong> from the “multicore” package rocks! <strong>parLapply</strong> from the “snow” package comes second. In my former experiment, the lapply function was the way to go when dealing with matrix just as big as 10k rows. The second best alternative was then <strong>mclapply</strong>. <strong>parLapply</strong> from “snow”, and <strong>sfLapply</strong> from the “snowfall” package were simply too slow.</p>

<p>Now, comparing the older graph with the following one suggests that a “microrevolution” is taking place; the figures changed a big deal upon parallelizing small data vectors &lt; 10k; distributing across CPUs seems to be less time consuming now than let it go serialized. Single-core computing (lapply function) is still an alternative when datasets are very small 1k to 10k. Nonetheless, if your data is greater than 10k rows, lapply will be your last desirable performance function.</p>

<p><img src="http://danielmarcelino.github.io/img/2014/parallelfinal.png" alt="Linear Relationship" /></p>


                <hr>

                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/blog/2014/Do-you-believe-in-World-Cup-superstition.html" data-toggle="tooltip" data-placement="top" title="Do you believe in World Cup superstition?">&larr; Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/blog/2014/discontinuity-bayesian-forecasting.html" data-toggle="tooltip" data-placement="top" title="Discontinuity Bayesian Forecasting">Next Post &rarr;</a>
                    </li>
                    
                </ul>
		  	  

            </div>
        </div>
    </div>
</article>

<hr>


    


    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    <li>
                        <a href="/feed.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="https://twitter.com/dmarcelinobr">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    
                    <li>
                        <a href="https://github.com/danielmarcelino">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
		            

		            
                    
                    <li>
                        <a href="mailto:dmarcelino@live.com">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                </ul>
                <p class="syndicated text-center footer-links">
                 Some contents of this blog are contributed to <a  href="http://www.statsblogs.com">Statsblogs</a> and 
<a href="http://www.r-bloggers.com">R-Bloggers</a>, the largest blog aggregator for R related content. 
<br/>
</p>
        <p class="copyright text-muted">
          &copy; Daniel Marcelino
          &nbsp;&bull;&nbsp;
          2016 
&nbsp;&bull;&nbsp;
<a href="http://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">(CC) BY-NC-SA</a>
        </p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/clean-blog.min.js "></script>


</body>

</html>
