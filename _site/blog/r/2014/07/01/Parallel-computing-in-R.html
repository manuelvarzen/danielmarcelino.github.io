<!DOCTYPE html>
<html lang="en">
	<head>
        <title>Parallel computing in R | Daniel Marcelino</title>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
        <meta name="keywords" content="methods, data analysis, R programming" />
        <meta name="author" content="Daniel Marcelino" />
        <meta name="description" content="Website of Daniel Marcelino" />
        <meta name="viewport" content="width=640px, initial-scale=1.0, maximum-scale=1.0">	
        <!-- favicon -->
        <link rel="shortcut icon" href="/images/favicon.ico">
        <!-- Google Fonts -->
		<link href="http://fonts.googleapis.com/css?family=Open+Sans:300italic,300,400,600" rel="stylesheet" type="text/css">
		<link href='http://fonts.googleapis.com/css?family=Vollkorn' rel='stylesheet' type='text/css'>
        <!-- Custom CSS -->
        <link rel="stylesheet" href="/css/main.css" type="text/css" media="screen, projection" />
		<link rel="alternate" type="application/rss+xml" title="EnfoRced Data Analysis" href="/feed.xml">
	<link rel="alternate" type="application/rss+xml" title="EnfoRced Data Analysis" href="/feed.r.xml">
		<link rel="alternate" type="application/atom+xml" title="EnfoRced Data Analysis" href="/atom.xml" />
		
	
</head>

	<body>


		<script type="text/javascript"
    src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<div class="header-page">

<h1><a href="/"><span style='font-weight: bold;'>Daniel Marcelino</span></a></h1></span>
<div id="nav">
	<ul>
	   <li><a href="/blog" class="current"><strong>Blog</strong></a></li>
		<li><a href="/about" class=""><strong>About</strong></a></li>
	<li><a href="/research" class=""><strong>Research</strong></a></li>
		<li><a href="/teaching" class=""><strong>Teaching</strong></a></li>
		<li><a href="/software" class=""><strong>Software</strong></a></li>		
	<li><a href="/randomwalks" class=""><strong>Random Walks</strong></a></li>		
	</ul>
</div>

</div>


<div class="clear"></div>

<div id="block">
	<div class="prose"> 
	<div class="post">
	<h1> Parallel computing in R </h1>
	<!-- <span class="date">Posted on 01 Jul 2014</span> -->
	<h5>Posted on July 01, 2014</h5>
	
	<p>Parallel computing is incredibly useful, but not every thing worths distribute across as many cores as possible.</p>

<!--more-->

<p><img src="/images/blog/2014/parallel.png" alt="Experiment Result" /></p>

<p>Roughly a year ago I published an article about parallel computing in R <a href="http://danielmarcelino.com/r/05-2013/parallel-processing-when-does-it-worth/">here</a>, in which I compared computation performance among 4 packages that provide R with parallel features once R is essentially a single-thread task package.</p>

<p>Parallel computing is incredibly useful, but not every thing worths distribute across as many cores as possible. Actually, there are cases without enough repetitions that R will gain in performance through serial computation. That is, R takes time to distribute tasks across the processors; conversely, it will need time for binding them all together later on. Therefore, if the time for distributing and gathering pieces together is greater than than the time need for single-thread computing, it doesn’t worth parallelize.</p>

<p>In this post I’ll perform the same experiment using the same physical resources, except that I will perform it in the Rstudio instead of Emacs. So I want to check whether the packages improved anything significant so far.</p>

<p>I tested a nontrivial computation instance using four critical R functions: the base <strong>lapply</strong>, <strong>mclapply</strong> from the “multicore” package, <strong>parLapply</strong> from the “snow” package, and <strong>sfLapply</strong> from the “snowfall” package. The last three functions essentially provide parallelized equivalent for the lapply.</p>

<h4 id="the-experiment">The Experiment</h4>
<p>These packages were used for distributing tasks across four CPUs of my MacBook pro with 8-G memory. The duty was to average out each column of a data frame built on the fly, but repeating this procedure 100 times for each trial because I don’t want to rely on one single round estimate. In addition, each trial demands different amount of memory allocation and time for computing once the matrix size varies as 1K, 10K, 100K, 1M, and 10M rows. The program I used to perform the tests is left <a href="https://gist.github.com/danielmarcelino/5668701">here</a>.</p>

<p>Overall, every function is doing a better job now than one year ago, but the <strong>mclapply</strong> from the “multicore” package rocks! <strong>parLapply</strong> from the “snow” package comes second. In my former experiment, the lapply function was the way to go when dealing with matrix just as big as 10k rows. The second best alternative was then <strong>mclapply</strong>. <strong>parLapply</strong> from “snow”, and <strong>sfLapply</strong> from the “snowfall” package were simply too slow.</p>

<p>Now, comparing the older graph with the following one suggests that a “microrevolution” is taking place; the figures changed a big deal upon parallelizing small data vectors &lt; 10k; distributing across CPUs seems to be less time consuming now than let it go serialized. Single-core computing (lapply function) is still an alternative when datasets are very small 1k to 10k. Nonetheless, if your data is greater than 10k rows, lapply will be your last desirable performance function.</p>

<p><img src="/images/blog/2014/parallelfinal.png" alt="Linear Relationship" /></p>


</div>

<hr>
<p></p>

<div class="meta">
	
	
	<span class="categories">
		Published in categories
		
		<a href="/blog/categories/#r" title="r">r</a>&nbsp;
		
	</span>
	
	
	
	<span class="tags">
		Tagged with 
		
		<a href="/blog/tags/#R" title="R">R</a>&nbsp;
		
		<a href="/blog/tags/#parallel computing" title="parallel computing">parallel computing</a>&nbsp;
		
	</span>
	
</div>


<div class="previous_next">
	
	  <a href="/blog/r/2014/06/24/Do-you-believe-in-World-Cup-superstition%3F.html" title="Previous post">&larr; previous</a>
	
	&nbsp;&nbsp;
	
	  <a href="/blog/r/2014/09/17/bayes-says-dont-worry-about-scotlands-referendum.html" title="Next post">next &rarr;</a>
	
	<br>
	<p>
	<a class="greenbutton" href="/blog/archive/" title="an archive of all posts">See all posts &rarr;</a>
	</p>
</div>


<div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'daniel-marcelino'; // required: replace example with your forum short name

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
	</div>
</div>


<div id="footer">

<div id="footer">
The contents of this blog is syndicated to <a href="http://www.r-bloggers.com">R-Bloggers</a> and <a href="http://www.statsblogs.com">Statsblogs</a> via <a href="http://danielmarcelino.com/atom.xml"> Atom/RSS feeds.</a> <br/><br/>
	&copy; <a href="/">Daniel Marcelino</a>. All contents under 
	<a href="http://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">(CC) BY-NC-SA license</a>, 
	unless otherwise noted.
	<br/><br/>
	Did you find this site useful? If yes, consider helping me with my  
	<a href="http://amzn.com/w/2CCCV54KPGIA2" target="_blank">wishlist</a>.
</div>


</div>




		<!-- Google Analytics -->
		<script>
  		  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  		  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  		  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  		  })(window, document,'script','//www.google-analytics.com/analytics.js','ga');

	  	  ga('create', 'UA-24186657-1', 'danielmarcelino.com');
  		  ga('send', 'pageview');

		</script>
		<!-- Google Analytics end -->

	</body>
</html>