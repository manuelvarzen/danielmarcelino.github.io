<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Everything Ends on Wednesday &#8211; Data * Analysis + R</title>
<meta name="description" content="This post approaches HIV incidence rate among Brazilians and simulates several levels of HIV infection.">
<meta name="keywords" content="R, rstats">


<!-- Twitter Cards -->
<meta name="twitter:title" content="Everything Ends on Wednesday">
<meta name="twitter:description" content="This post approaches HIV incidence rate among Brazilians and simulates several levels of HIV infection.">
<meta name="twitter:site" content="@dmarcelinobr">
<meta name="twitter:creator" content="@dmarcelinobr">

<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://danielmarcelino.github.io/images/">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Everything Ends on Wednesday">
<meta property="og:description" content="This post approaches HIV incidence rate among Brazilians and simulates several levels of HIV infection.">
<meta property="og:url" content="http://danielmarcelino.github.io/blog/2016/Everything-Ends-on-Wednesday.html">
<meta property="og:site_name" content="Data * Analysis + R">





<link rel="canonical" href="http://danielmarcelino.github.io/blog/2016/Everything-Ends-on-Wednesday.html">
<link href="http://danielmarcelino.github.io/feed.xml" type="application/atom+xml" rel="alternate" title="Data * Analysis + R Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="http://danielmarcelino.github.io/assets/css/main.css">
<!-- Webfonts -->
<script src="https://use.edgefonts.net/source-sans-pro:n2,i2,n3,i3,n4,i4,n6,i6,n7,i7,n9,i9;source-code-pro:n4,n7;volkhov.js"></script>

<meta http-equiv="cleartype" content="on">

<!-- HTML5 Shiv and Media Query Support -->
<!--[if lt IE 9]>
  <script src="http://danielmarcelino.github.io/assets/js/vendor/html5shiv.min.js"></script>
  <script src="http://danielmarcelino.github.io/assets/js/vendor/respond.min.js"></script>
<![endif]-->

<!-- Modernizr -->
<script src="http://danielmarcelino.github.io/assets/js/vendor/modernizr-2.7.1.custom.min.js"></script>


<!-- MathJax -->
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="http://danielmarcelino.github.io/favicon.ico?r=31241">
<!-- 32x32 -->
<link rel="shortcut icon" href="http://danielmarcelino.github.io/favicon.png?r=31241">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="http://danielmarcelino.github.io/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://danielmarcelino.github.io/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://danielmarcelino.github.io/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://danielmarcelino.github.io/images/apple-touch-icon-144x144-precomposed.png">

</head>

<body id="post">

<div class="navigation-wrapper">
	<nav role="navigation" id="site-nav" class="animated drop">
	    <ul>
      
		    
		    <li><a href="http://danielmarcelino.github.io/blog/" >Blog</a></li>
		  
		    
		    <li><a href="http://danielmarcelino.github.io/interests/" >Interests</a></li>
		  
		    
		    <li><a href="http://danielmarcelino.github.io/about/" >About</a></li>
		  
		    
		    <li><a href="http://danielmarcelino.github.io/randomwalks/" >Random Walks</a></li>
		  
		    
		    <li><a href="http://danielmarcelino.github.io/resources/" >Resources</a></li>
		  
		    
		    <li><a href="http://danielmarcelino.github.io/search/" >Search</a></li>
		  
	    </ul>
	</nav>
</div><!-- /.navigation-wrapper -->

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->

<header class="masthead">
	<div class="wrap">
      
      <h1 class="site-title animated fadeIn"><a href="http://danielmarcelino.github.io/">Data * Analysis + R</a></h1>
		<h2 class="site-description animated fadeIn" itemprop="description">Blog of Daniel Marcelino</h2>
	</div>
</header><!-- /.masthead -->

<div class="js-menu-screen menu-screen"></div>


<div id="main" role="main">
  <article class="hentry">
    
    <div class="entry-wrapper">
      <header class="entry-header">
        <span class="entry-tags"><a href="http://danielmarcelino.github.io/tags/#R" title="Pages tagged R">R</a>&nbsp;&bull;&nbsp;<a href="http://danielmarcelino.github.io/tags/#rstats" title="Pages tagged rstats">rstats</a></span>
        
          <h1 class="entry-title">Everything Ends on Wednesday</h1>
        
      </header>
      <footer class="entry-meta">
        
        
          <img src="http://danielmarcelino.github.io/img/DSC02844.jpg" class="bio-photo" alt="Daniel Marcelino bio photo"></a>
        
        <span class="author vcard">By <span class="fn">Daniel Marcelino</span></span>
        <span class="entry-date date published"><time datetime="2016-02-12T00:00:00-02:00"><i class="fa fa-calendar-o"></i> February 12, 2016</time></span>
        
        <span class="entry-comments"><i class="fa fa-comment-o"></i> <a href="#disqus_thread">Comment</a></span>
        <span class="social-share-twitter">
  <a href="https://twitter.com/intent/tweet?hashtags=R,rstats&amp;text=Everything%20Ends%20on%20Wednesday&amp;url=http://danielmarcelino.github.io/blog/2016/Everything-Ends-on-Wednesday.html&amp;via=dmarcelinobr" title="Share on Twitter" itemprop="Twitter"><i class="fa fa-twitter-square"></i> Tweet</a>
</span>
<span class="social-share-facebook">
  <a href="https://www.facebook.com/sharer/sharer.php?u=http://danielmarcelino.github.io/blog/2016/Everything-Ends-on-Wednesday.html" title="Share on Facebook" itemprop="Facebook"><i class="fa fa-facebook-square"></i> Like</a>
</span>
<span class="social-share-googleplus">
  <a href="https://plus.google.com/share?url=http://danielmarcelino.github.io/blog/2016/Everything-Ends-on-Wednesday.html" title="Share on Google Plus" itemprop="GooglePlus"><i class="fa fa-google-plus-square"></i> +1</a>
</span>
<!-- /.social-share -->
        
      </footer>
      <div class="entry-content">
        <p>The Brazilian Carnival just ended this week, but for some people it is time to starting worry about crazy things that may have happened over the days of the flesh festival.</p>

<p>Watching the news, the spokesperson of the Test and Prevention Center (CTA) in Brasilia estimated that the number of people seeking counseling and test kits increases on average 40% the day after the carnival (Wednesday). He also disclosed that 2 out of 124 performed tests (most likely staff finger stick tests) turned out positive.</p>

<p>After the news I started thinking of HIV incidence among Brazilians and how likely it is to be tested positive when incidence levels also change; every year these numbers go up and dow accordingly to the government policies.</p>

<p>After a little research, I found several sources with estimated quantities of the incidence of HIV/AIDS. The one I chose, says for instance, in 2011 the incidence rate of AIDS (stage when the disease manifests itself in the patient) in Brazil was 17.9 to 100,000 inhabitants. This number varies  significantly across the regions, so it’s higher in South-East and lower in the Midwest of the country, with others regions falling in between. The incidence rate also varies between males and females, and among age groups. For the sake of simplicity, I will not consider those differences here. It would get too complicated for a blog post post-carnival.</p>

<p>Consider that the <a href="https://en.wikipedia.org/wiki/ELISA">enzyme-linked immunosorbent assay (ELISA screening test)</a> for testing a blood sample for the HIV antibodies being present in human blood has the following properties:</p>

<p>Sensitivity:</p>

<script type="math/tex; mode=display">P(positive~ELISA~|~person~is~HIV~positive) = .977</script>

<p>Specificity:</p>

<script type="math/tex; mode=display">P(negative~ELISA~|~person~is~HIV~negative) = .926</script>

<p><strong>Sensitivity</strong> is the percentage of individuals with HIV infection (based on ELISA reading) whom  correctly identified as having infection (aka the true positive rate). <strong>Specificity</strong> is the percentage of individuals without HIV infection (based on ELISA reading) whom correctly identified as being free of infection (aka true negative rate). No test is perfect, as a consequence, few individuals will receive false negatives and others false positives.</p>

<p>Suppose the incidence of HIV in the population being tested is denoted by p . Replacing: <em>p = 18/100000</em> or <em>0.00018</em>. Using the Law of Total Probability we can show this relation as:</p>

<script type="math/tex; mode=display">P(HIV~positive~|~positive~ELISA) = p * .977~/~(p * .977 + (1-p) * .074)</script>

<p>Here is the output and R code computing this for various values of p with a 25 interval.</p>

<p><img src="http://danielmarcelino.github.io/img/2016/Sensitivity.png" alt="center" /></p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">cases</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">seq</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">10000</span><span class="p">,</span><span class="w"> </span><span class="m">25</span><span class="p">)</span><span class="w">

</span><span class="n">p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">cases</span><span class="o">/</span><span class="m">100000</span><span class="p">)</span><span class="w">
</span><span class="n">prob</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">p</span><span class="o">*</span><span class="m">.977</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="o">*</span><span class="m">.977</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="m">1</span><span class="o">-</span><span class="n">p</span><span class="p">)</span><span class="o">*</span><span class="m">.074</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="o">&gt;</span><span class="w"> </span><span class="n">head</span><span class="p">(</span><span class="nf">round</span><span class="p">(</span><span class="n">cbind</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">prob</span><span class="p">),</span><span class="m">3</span><span class="p">),</span><span class="w"> </span><span class="m">10</span><span class="p">)</span><span class="w">
          </span><span class="n">p</span><span class="w">  </span><span class="n">prob</span><span class="w">
 </span><span class="p">[</span><span class="m">1</span><span class="p">,]</span><span class="w"> </span><span class="m">0.000</span><span class="w"> </span><span class="m">0.000</span><span class="w">
 </span><span class="p">[</span><span class="m">2</span><span class="p">,]</span><span class="w"> </span><span class="m">0.000</span><span class="w"> </span><span class="m">0.003</span><span class="w">
 </span><span class="p">[</span><span class="m">3</span><span class="p">,]</span><span class="w"> </span><span class="m">0.000</span><span class="w"> </span><span class="m">0.007</span><span class="w">
 </span><span class="p">[</span><span class="m">4</span><span class="p">,]</span><span class="w"> </span><span class="m">0.001</span><span class="w"> </span><span class="m">0.010</span><span class="w">
 </span><span class="p">[</span><span class="m">5</span><span class="p">,]</span><span class="w"> </span><span class="m">0.001</span><span class="w"> </span><span class="m">0.013</span><span class="w">
 </span><span class="p">[</span><span class="m">6</span><span class="p">,]</span><span class="w"> </span><span class="m">0.001</span><span class="w"> </span><span class="m">0.016</span><span class="w">
 </span><span class="p">[</span><span class="m">7</span><span class="p">,]</span><span class="w"> </span><span class="m">0.002</span><span class="w"> </span><span class="m">0.019</span><span class="w">
 </span><span class="p">[</span><span class="m">8</span><span class="p">,]</span><span class="w"> </span><span class="m">0.002</span><span class="w"> </span><span class="m">0.023</span><span class="w">
 </span><span class="p">[</span><span class="m">9</span><span class="p">,]</span><span class="w"> </span><span class="m">0.002</span><span class="w"> </span><span class="m">0.026</span><span class="w">
</span><span class="p">[</span><span class="m">10</span><span class="p">,]</span><span class="w"> </span><span class="m">0.002</span><span class="w"> </span><span class="m">0.029</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="w"> </span><span class="n">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span><span class="w">
 </span><span class="n">library</span><span class="p">(</span><span class="n">SciencesPo</span><span class="p">)</span><span class="w"> </span><span class="c1"># for using theme_538
</span><span class="n">ggplot</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> 
</span><span class="n">geom_line</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">prob</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">),</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">theme_538</span><span class="p">()</span><span class="w">

 </span></code></pre></figure>

<p>I’m not in the field of epidemiology or biostatistics, but this simple experiment teaches two things. First, it is really important to keep the incidence rate low. Assuming we randomly selected you for the test, when <em>p</em> is really small, it’s much more likely that you got a false positive (you are positive when you are in fact negative). But as <em>p</em> gets larger, it becomes more likely that you do have the infection and the test result is accurate. Second, the accuracy of the test “improves” as a by-product of the incidence/prevalence among elements within the population.</p>

        
          <div id="disqus_thread"></div><!-- /#disqus_thread -->
          
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'daniel-marcelino'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'https://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

        
      </div><!-- /.entry-content -->
    </div><!-- /.entry-wrapper -->
    <nav class="pagination" role="navigation">
      
        <a href="http://danielmarcelino.github.io/blog/2016/star-wars-grossing-war.html" class="btn" title="The Star Wars Grossing War">Previous</a>
      
      
        <a href="http://danielmarcelino.github.io/blog/2016/how-fast-are-we-growing.html" class="btn" title="R packaging industry close-up: How fast are we growing?">Next</a>
      
    </nav><!-- /.pagination -->
  </article>
</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo" class="entry-wrapper">
    

<span>&copy; 2016 Daniel Marcelino</span>
<div class="social-icons">
	<a href="https://twitter.com/dmarcelinobr" title="Daniel Marcelino on Twitter" target="_blank"><i class="fa fa-twitter-square fa-2x"></i></a>
	<a href="https://facebook.com/daniel.marcelino.796" title="Daniel Marcelino on Facebook" target="_blank"><i class="fa fa-facebook-square fa-2x"></i></a>
	
	<a href="https://linkedin.com/in/daniel-marcelino-80968656" title="Daniel Marcelino on LinkedIn" target="_blank"><i class="fa fa-linkedin-square fa-2x"></i></a>
	<a href="http://stackoverflow.com/users/792000/daniel" title="Daniel Marcelino on StackExchange" target="_blank"><i class="fa fa-stack-exchange fa-2x"></i></a>
	<a href="https://instagram.com/dmarcelinobr" title="Daniel Marcelino on Instagram" target="_blank"><i class="fa fa-instagram fa-2x"></i></a>
	
	<a href="https://github.com/danielmarcelino" title="Daniel Marcelino on Github" target="_blank"><i class="fa fa-github-square fa-2x"></i></a>
	
  
	
  <a href="http://danielmarcelino.github.io/feed.xml" title="Atom/RSS feed"><i class="fa fa-rss-square fa-2x"></i></a>
</div><!-- /.social-icons -->

  </footer>
</div><!-- /.footer-wrapper -->

<script type="text/javascript">
  var BASE_URL = 'http://danielmarcelino.github.io';
</script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="http://danielmarcelino.github.io/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="http://danielmarcelino.github.io/assets/js/scripts.min.js"></script>


<!-- Asynchronous Google Analytics snippet -->
<script>
  var _gaq = _gaq || [];
  var pluginUrl =
 'https://www.google-analytics.com/plugins/ga/inpage_linkid.js';
  _gaq.push(['_require', 'inpage_linkid', pluginUrl]);
  _gaq.push(['_setAccount', 'UA-24186657-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = 'https://stats.g.doubleclick.net/dc.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-24186657-1', 'auto');
  ga('send', 'pageview');

</script>


<!-- htmlwidgets dependencies --> 
<script src="/htmlwidgets_deps/htmlwidgets-0.5/htmlwidgets.js"></script>
<script src="/htmlwidgets_deps/d3-3.5.3/d3.min.js"></script>
<link href="/htmlwidgets_deps/colorbrewer-1/colorbrewer.css" rel="stylesheet" />
<script src="/htmlwidgets_deps/colorbrewer-1/colorbrewer.js"></script>
<link href="/htmlwidgets_deps/streamgraph-1/streamgraph.css" rel="stylesheet" />
<script src="/htmlwidgets_deps/streamgraph-binding-0.8.1/streamgraph.js"></script>


</body>
</html>
