<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <meta name="keywords" content="Daniel Marcelino, SciencesPo, SoundexBR, r-project, r, political science, political behavior, social sciences, statistics, methods, applied methods, programming, data mining, data visualization, datascience, big data"/>	
	<meta name="google-site-verification" content="Vk0IOJ2jwG_qEoG7fuEXYqv0m2rLa8P778Fi_GrsgEQ" />
	<meta name="bing_webmastertools_id" content="97837256955BD270FD688E2B50F89FDB" />
    <meta name="author" content="Daniel Marcelino" />
	 <meta name="title" content="&middot; Daniel &middot; Everything Ends on Wednesday" />
	 
	   <!-- favicon -->
	<link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon" />
	
	
  
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
  <!-- MathJax configuration -->
  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
      tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"] ],
          displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
          processEscapes: true,
          processEnvironments: true
      },
      TeX: {
          equationNumbers: { autoNumber: "AMS" }
      },
      // Center justify equations in code and markdown cells. Elsewhere
      // we use CSS to left justify single line equations in code cells.
      displayAlign: 'center',
      "HTML-CSS": {
          styles: {'.MathJax_Display': {"margin": 0}},
          linebreaks: { automatic: false },
          scale: 100
      }
  });
  </script>


  
    
      <link rel="stylesheet" href="/css/bootstrap.min.css" />
    
      <link rel="stylesheet" href="/css/main.css" />
    
  
  

  
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" />
  


  
    
      <link rel="stylesheet" href="/js/jquery-1.11.2.min.js" />
    
      <link rel="stylesheet" href="/js/bootstrap.min.js" />
    
      <link rel="stylesheet" href="/js/main.js" />
    
  
    
  
  
 <title>EnfoRced Data Analysis</title>
   

  
  
  <meta name="description" content="HIV testing after Carnival">
  
  
  <link rel="alternate" type="application/rss+xml" title="EnfoRced Data Analysis - Blog of Daniel Marcelino" href="/feed.xml" />

    
  
  
  
  

    
  
  
  
  
  
  <!-- Facebook OpenGraph tags -->
  
  <meta property="og:title" content="Everything Ends on Wednesday" />
  
  
  <meta property="og:type" content="website" />
  
  
  <meta property="og:url" content="http://danielmarcelino.github.io/blog/2016/Everything-Ends-on-Wednesday.html/" />
  
  
  
  <meta property="og:image" content="http://danielmarcelino.github.io/images/daniel_rio.jpg" />
  

</head>


  <body>

    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="http://danielmarcelino.github.io">EnfoRced Data Analysis</a>
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
	    
        <li>
		  <a href="/blog">Blog</a>
		</li>
		
        <li>
		  <a href="/interests">Interests</a>
		</li>
		
        <li>
		  <a href="/randomwalks">Random Walks</a>
		</li>
		
        <li>
		  <a href="/about">About</a>
		</li>
		
		
		
		<li>
		  <a href="/search" class="nav-search-link" title="Search">
		    <span class="fa fa-search nav-search-icon"></span>
			<span class="nav-search-text">Search</span>
		  </a>
		</li>
		
      </ul>
    </div>
	
	
	<div class="avatar-container">
	  <div class="avatar-img-border">
	    <a href="http://danielmarcelino.github.io ">
	      <img class="avatar-img" src="/images/daniel_rio.jpg" />
		</a>
	  </div>
	</div>
	
	
  </div>
</nav>  

    <head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <meta name="keywords" content="Daniel Marcelino, SciencesPo, SoundexBR, r-project, r, political science, political behavior, social sciences, statistics, methods, applied methods, programming, data mining, data visualization, datascience, big data"/>	
	<meta name="google-site-verification" content="Vk0IOJ2jwG_qEoG7fuEXYqv0m2rLa8P778Fi_GrsgEQ" />
	<meta name="bing_webmastertools_id" content="97837256955BD270FD688E2B50F89FDB" />
    <meta name="author" content="Daniel Marcelino" />
	 <meta name="title" content="&middot; Daniel &middot; Everything Ends on Wednesday" />
	 
	   <!-- favicon -->
	<link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon" />
	
	
  
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
  <!-- MathJax configuration -->
  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
      tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"] ],
          displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
          processEscapes: true,
          processEnvironments: true
      },
      TeX: {
          equationNumbers: { autoNumber: "AMS" }
      },
      // Center justify equations in code and markdown cells. Elsewhere
      // we use CSS to left justify single line equations in code cells.
      displayAlign: 'center',
      "HTML-CSS": {
          styles: {'.MathJax_Display': {"margin": 0}},
          linebreaks: { automatic: false },
          scale: 100
      }
  });
  </script>


  
    
      <link rel="stylesheet" href="/css/bootstrap.min.css" />
    
      <link rel="stylesheet" href="/css/main.css" />
    
  
  

  
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" />
  


  
    
      <link rel="stylesheet" href="/js/jquery-1.11.2.min.js" />
    
      <link rel="stylesheet" href="/js/bootstrap.min.js" />
    
      <link rel="stylesheet" href="/js/main.js" />
    
  
    
  
  
 <title>EnfoRced Data Analysis</title>
   

  
  
  <meta name="description" content="HIV testing after Carnival">
  
  
  <link rel="alternate" type="application/rss+xml" title="EnfoRced Data Analysis - Blog of Daniel Marcelino" href="/feed.xml" />

    
  
  
  
  

    
  
  
  
  
  
  <!-- Facebook OpenGraph tags -->
  
  <meta property="og:title" content="Everything Ends on Wednesday" />
  
  
  <meta property="og:type" content="website" />
  
  
  <meta property="og:url" content="http://danielmarcelino.github.io/blog/2016/Everything-Ends-on-Wednesday.html/" />
  
  
  
  <meta property="og:image" content="http://danielmarcelino.github.io/images/daniel_rio.jpg" />
  

</head>





<header class="header-section ">

<div class="intro-header no-img">
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <div class="post-heading">
          <h1>Everything Ends on Wednesday</h1>
		  
		    
			<h2 class="post-subheading">HIV testing after Carnival</h2>
			
		  
		  
		  
		  <span class="post-meta">Posted on February 12, 2016</span>
		  
        </div>
      </div>
    </div>
  </div>
</div>
</header>





<div class="container">
  <div class="row">
    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
      <article role="main" class="blog-post">
	    <p>The Brazilian Carnival just finished this week, but for some people it is time to start worrying about crazy things that may have happened over the days of the flesh festival.</p>

<p>Watching the news, the spoken person of the Test and Prevention Center (CTA) of Brasilia estimated that people seeking test services by this institution increases on average 40% the day after the carnival. By the end the day, the spoken person reveled that 2 out of 124 performed rapid tests (most likely staff finger stick tests) turned out positive.</p>

<p>I started to thinking about incidence of HIV among Brazilians and how likely it’s to be tested positive when incidence levels also change.</p>

<p>After a little research, I found several sources with estimated quantities of the incidence for  several countries. For instance, in 2011, the incidence rate of AIDS (stage when the disease manifests itself in the patient) in Brazil was 17.9 to 100,000 inhabitants. This number varies  significantly across the regions, so it’s higher in South-East and lower in the Midwest of the country, with others regions falling in between. The incidence rate also varies between males and females and among age groups. For the sake of simplicity I will not consider those differences here. It would get too complicated for a blog post post-carnival.</p>

<p>The <a href="https://en.wikipedia.org/wiki/ELISA">enzyme-linked immunosorbent assay (ELISA screening test)</a>  for testing a blood sample for the HIV antibodies being present in human blood has these properties:</p>

<p>Sensitivity:</p>

<script type="math/tex; mode=display">P(positive~ELISA~|~person~is~HIV~positive) = .977</script>

<p>Specificity:</p>

<script type="math/tex; mode=display">P(negative~ELISA~|~person~is~HIV~negative) = .926</script>

<p><strong>Sensitivity</strong> is the percentage of individuals with HIV infection (based on ELISA reading) whom  correctly identified as having infection (aka the true positive rate). <strong>Specificity</strong> is the percentage of individuals without HIV infection (based on ELISA reading) whom correctly identified as being free of infection (aka true negative rate);</p>

<p>Suppose the incidence of HIV in the population being tested is denoted by p . In class <em>p = 18/100000</em> – or <em>0.00018</em>. In general we can show this relation using the Law of Total Probability:</p>

<script type="math/tex; mode=display">P(HIV~positive~|~positive~ELISA) = p * .977~/~(p * .977 + (1-p) * .074)</script>

<p>Here is the output and R code  computing this for various values of p with a 25 interval.</p>

<p><img src="http://danielmarcelino.github.io/images/2016/Sensitivity.png" alt="center" /></p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">cases</span> <span class="o">&lt;-</span> <span class="n">seq</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">10000</span><span class="p">,</span> <span class="m">25</span><span class="p">)</span>

<span class="n">p</span> <span class="o">&lt;-</span> <span class="n">c</span><span class="p">(</span><span class="n">cases</span><span class="o">/</span><span class="m">100000</span><span class="p">)</span>
<span class="n">prob</span> <span class="o">&lt;-</span> <span class="n">p</span><span class="o">*</span><span class="m">.977</span> <span class="o">/</span> <span class="p">(</span><span class="n">p</span><span class="o">*</span><span class="m">.977</span> <span class="o">+</span> <span class="p">(</span><span class="m">1</span><span class="o">-</span><span class="n">p</span><span class="p">)</span><span class="o">*</span><span class="m">.074</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="o">&gt;</span> <span class="n">head</span><span class="p">(</span><span class="n">round</span><span class="p">(</span><span class="n">cbind</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">prob</span><span class="p">),</span><span class="m">3</span><span class="p">),</span> <span class="m">10</span><span class="p">)</span>
          <span class="n">p</span>  <span class="n">prob</span>
 <span class="p">[</span><span class="m">1</span><span class="p">,]</span> <span class="m">0.000</span> <span class="m">0.000</span>
 <span class="p">[</span><span class="m">2</span><span class="p">,]</span> <span class="m">0.000</span> <span class="m">0.003</span>
 <span class="p">[</span><span class="m">3</span><span class="p">,]</span> <span class="m">0.000</span> <span class="m">0.007</span>
 <span class="p">[</span><span class="m">4</span><span class="p">,]</span> <span class="m">0.001</span> <span class="m">0.010</span>
 <span class="p">[</span><span class="m">5</span><span class="p">,]</span> <span class="m">0.001</span> <span class="m">0.013</span>
 <span class="p">[</span><span class="m">6</span><span class="p">,]</span> <span class="m">0.001</span> <span class="m">0.016</span>
 <span class="p">[</span><span class="m">7</span><span class="p">,]</span> <span class="m">0.002</span> <span class="m">0.019</span>
 <span class="p">[</span><span class="m">8</span><span class="p">,]</span> <span class="m">0.002</span> <span class="m">0.023</span>
 <span class="p">[</span><span class="m">9</span><span class="p">,]</span> <span class="m">0.002</span> <span class="m">0.026</span>
<span class="p">[</span><span class="m">10</span><span class="p">,]</span> <span class="m">0.002</span> <span class="m">0.029</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-r" data-lang="r"> <span class="n">library</span><span class="p">(</span><span class="n">SciencesPo</span><span class="p">)</span> <span class="c1"># for using theme_538
</span><span class="n">ggplot</span><span class="p">()</span> <span class="o">+</span> 
<span class="n">geom_line</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">prob</span><span class="p">,</span> <span class="n">p</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="m">1</span><span class="p">)</span> <span class="o">+</span>
    <span class="n">theme_538</span><span class="p">()</span>

 </code></pre></figure>

<p>I’m not in the field of epidemiology or biostatistics, but this simple experiment teaches two things. First, it is really important to keep the incidence rate low. Assuming we randonly selected you for the test, when <em>p</em> is really small, it’s much more likely that you got a false positive (you are positive when you are in fact negative). But as <em>p</em> gets larger, it becomes more likely that you do have the infection and the test result is accurate. Second, the accuracy of the test “improves” as a by-product of the incidence/prevalence among elements within the population.</p>

	  </article>
	  
	  
	  <div class="blog-tags">
		Tags: R
	  </div>
	  
	  
      <ul class="pager blog-pager">
        
        <li class="previous">
          <a href="/blog/2016/star-wars-grossing-war.html" data-toggle="tooltip" data-placement="top" title="The Star Wars Grossing War">&larr; Previous Post</a>
        </li>
        
        
      </ul>

      
        <div class="share-section">
  <h3 class="share-title">Liked what you read? Don't be selfish!</h3>
  <div class="share-buttons">
    
    
    
    

    
    
    
    
    <a href="http://danielmarcelino.github.io/contact" data-ga-event=1 data-ga-category="share" data-ga-action="message" data-ga-label="/blog/2016/Everything-Ends-on-Wednesday.html">
      Let me know
    </a>
    <a href="https://www.facebook.com/dialog/feed?app_id=1529566150689415&link=http://danielmarcelino.github.io/blog/2016/Everything-Ends-on-Wednesday.html&name=Everything Ends on Wednesday&caption=&redirect_uri=http://danielmarcelino.github.io/blog/2016/Everything-Ends-on-Wednesday.html?message=Thanks for sharing!" data-ga-event=1 data-ga-category="share" data-ga-action="facebook" data-ga-label="/blog/2016/Everything-Ends-on-Wednesday.html">
      Share on Facebook
    </a>
    <a href="https://twitter.com/intent/tweet?url=http://danielmarcelino.github.io/blog/2016/Everything-Ends-on-Wednesday.html&via=daniel&text=Everything Ends on Wednesday" data-ga-event=1 data-ga-category="share" data-ga-action="twitter" data-ga-label="/blog/2016/Everything-Ends-on-Wednesday.html">
      Tweet it
    </a>
  </div>
</div>

      

	  
      <div class="disqus-comments">
	    
<div class="comments">
	<div id="disqus_thread"></div>
	<script type="text/javascript">
	    var disqus_shortname = 'daniel-marcelino';
	    // ensure that pages with query string get the same discussion
            var url_parts = window.location.href.split("?");
            var disqus_url = url_parts[0];

	    (function() {
	        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
	        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
	        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	    })();
	</script>
	<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>


      </div>
	  
    </div>
  </div>
</div>


    <footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">

          
          <li>
            <a href="mailto:dmarcelino@live.com?subject=Hello from " title="Email me">
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          

          
          <li>
            <a href="https://github.com/danielmarcelino/" title="GitHub">
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          

          
          <li>
            <a href="https://twitter.com/dmarcelinobr" title="Twitter">
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          

          

          
          <li>
            <a href="https://stackoverflow.com/users/792000/daniel" title="StackOverflow">
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-stack-overflow fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          

          
          <li>
            <a href="https://linkedin.com/daniel-marcelino-80968656" title="LinkedIn">
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          

          
          <li>
            <a href="/feed.xml" title="Subscribe to my blog">
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>		
          

        </ul>

<p class="syndicated text-center footer-links">
Some contents of this blog is also contributed to <a href="http://www.r-bloggers.com">R-Bloggers</a> and <a href="http://www.statsblogs.com">Statsblogs</a> 
<br/>
</p>
        <p class="copyright text-muted">
          &copy; Daniel Marcelino
          &nbsp;&bull;&nbsp;
          2016 
&nbsp;&bull;&nbsp;
<a href="http://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">(CC) BY-NC-SA</a>
        </p>
      </div>
    </div>
  </div>
</footer>


    








	<!-- Google Analytics -->
	<script>
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
		ga('create', 'UA-24186657-1', 'auto');
		ga('send', 'pageview');
	</script>
	<!-- End Google Analytics -->


  </body>
</html>
