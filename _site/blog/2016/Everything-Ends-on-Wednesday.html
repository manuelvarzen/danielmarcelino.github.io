<!DOCTYPE html>
<html lang="en">

<link rel="shortcut icon" href="/img/favicon.ico" type="image/x-icon" />

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Blog of Daniel Marcelino">

    <title>Everything Ends on Wednesday - Data * Analysis + R</title>

    <link rel="canonical" href="http://danielmarcelino.github.io/blog/2016/Everything-Ends-on-Wednesday.html">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/clean-blog.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="/css/syntax.css">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <link type="application/atom+xml" rel="alternate" href="http://danielmarcelino.github.io/feed.xml" title="Data * Analysis + R" />

</head>


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-24186657-1', 'danielmarcelino.github.io');
  ga('send', 'pageview');

</script>

<body>

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <!-- <a class="navbar-brand" href="/">Data * Analysis + R</a> -->
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="/">Home</a>
                </li>
                <li>
                    <a href="/blog/">Blog</a>
                </li>
                <li>
                    <a href="/interests/">Interests</a>
                </li>
                <li>
                    <a href="/randomwalks/">Random Walks</a>
                </li>
                  <li>
                    <a href="/about/">About</a>
                </li>
		  		<li>
		  		  <a href="/" class="nav-search-link" title="Search">
		  		    <span class="fa fa-search nav-search-icon"></span>
		  		  </a>
		  		</li>
		        </ul>
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>


    <script language="javascript">
    function typeset() {
        MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
    }

    function disqus_config() {
        this.callbacks.onNewComment = [typeset];
        this.callbacks.onInit = [typeset];
    }


    if(window.MathJax===undefined){
        var script = document.createElement("script");
        script.type = "text/javascript";
        script.src  = "http://cdn.mathjax.org/mathjax/latest/MathJax.js";
        var config = 'MathJax.Hub.Config({' +
                    'extensions: ["tex2jax.js"],' +
                    'tex2jax: { inlineMath: [ ["$","$"]], displayMath: [["\$$","\$$"]], processEscapes: true },' +
                    'jax: ["input/TeX","output/HTML-CSS"]' +
                    '});' +
                    'MathJax.Hub.Startup.onload();';
        if (window.opera)
            script.innerHTML = config;
        else
            script.text = config;
        document.getElementsByTagName("head")[0].appendChild(script);
    }
</script>


<!-- Post Header -->
<header class="intro-header" style="background-image: url('/img/website/spaghetti.png')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>Everything Ends on Wednesday</h1>
                    
                    <h2 class="subheading">HIV testing after Carnival</h2>
                    
                    <span class="meta">Posted by Daniel Marcelino on February 12, 2016</span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">

				<p>The Brazilian Carnival just ended this week, but for some people it is time to starting worry about crazy things that may have happened over the days of the flesh festival.</p>

<p>Watching the news, the spokesperson of the Test and Prevention Center (CTA) in Brasilia estimated that the number of people seeking counseling and test kits increases on average 40% the day after the carnival (Wednesday). He also disclosed that 2 out of 124 performed tests (most likely staff finger stick tests) turned out positive.</p>

<p>After the news I started thinking of HIV incidence among Brazilians and how likely it is to be tested positive when incidence levels also change; every year these numbers go up and dow accordingly to the government policies.</p>

<p>After a little research, I found several sources with estimated quantities of the incidence of HIV/AIDS. The one I chose, says for instance, in 2011 the incidence rate of AIDS (stage when the disease manifests itself in the patient) in Brazil was 17.9 to 100,000 inhabitants. This number varies  significantly across the regions, so it’s higher in South-East and lower in the Midwest of the country, with others regions falling in between. The incidence rate also varies between males and females, and among age groups. For the sake of simplicity, I will not consider those differences here. It would get too complicated for a blog post post-carnival.</p>

<p>Consider that the <a href="https://en.wikipedia.org/wiki/ELISA">enzyme-linked immunosorbent assay (ELISA screening test)</a> for testing a blood sample for the HIV antibodies being present in human blood has the following properties:</p>

<p>Sensitivity:</p>

<script type="math/tex; mode=display">P(positive~ELISA~|~person~is~HIV~positive) = .977</script>

<p>Specificity:</p>

<script type="math/tex; mode=display">P(negative~ELISA~|~person~is~HIV~negative) = .926</script>

<p><strong>Sensitivity</strong> is the percentage of individuals with HIV infection (based on ELISA reading) whom  correctly identified as having infection (aka the true positive rate). <strong>Specificity</strong> is the percentage of individuals without HIV infection (based on ELISA reading) whom correctly identified as being free of infection (aka true negative rate). No test is perfect, as a consequence, few individuals will receive false negatives and others false positives.</p>

<p>Suppose the incidence of HIV in the population being tested is denoted by p . Replacing: <em>p = 18/100000</em> or <em>0.00018</em>. Using the Law of Total Probability we can show this relation as:</p>

<script type="math/tex; mode=display">P(HIV~positive~|~positive~ELISA) = p * .977~/~(p * .977 + (1-p) * .074)</script>

<p>Here is the output and R code  computing this for various values of p with a 25 interval.</p>

<p><img src="http://danielmarcelino.github.io/img/2016/Sensitivity.png" alt="center" /></p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">cases</span> <span class="o">&lt;-</span> <span class="n">seq</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">10000</span><span class="p">,</span> <span class="m">25</span><span class="p">)</span>

<span class="n">p</span> <span class="o">&lt;-</span> <span class="n">c</span><span class="p">(</span><span class="n">cases</span><span class="o">/</span><span class="m">100000</span><span class="p">)</span>
<span class="n">prob</span> <span class="o">&lt;-</span> <span class="n">p</span><span class="o">*</span><span class="m">.977</span> <span class="o">/</span> <span class="p">(</span><span class="n">p</span><span class="o">*</span><span class="m">.977</span> <span class="o">+</span> <span class="p">(</span><span class="m">1</span><span class="o">-</span><span class="n">p</span><span class="p">)</span><span class="o">*</span><span class="m">.074</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="o">&gt;</span> <span class="n">head</span><span class="p">(</span><span class="n">round</span><span class="p">(</span><span class="n">cbind</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">prob</span><span class="p">),</span><span class="m">3</span><span class="p">),</span> <span class="m">10</span><span class="p">)</span>
          <span class="n">p</span>  <span class="n">prob</span>
 <span class="p">[</span><span class="m">1</span><span class="p">,]</span> <span class="m">0.000</span> <span class="m">0.000</span>
 <span class="p">[</span><span class="m">2</span><span class="p">,]</span> <span class="m">0.000</span> <span class="m">0.003</span>
 <span class="p">[</span><span class="m">3</span><span class="p">,]</span> <span class="m">0.000</span> <span class="m">0.007</span>
 <span class="p">[</span><span class="m">4</span><span class="p">,]</span> <span class="m">0.001</span> <span class="m">0.010</span>
 <span class="p">[</span><span class="m">5</span><span class="p">,]</span> <span class="m">0.001</span> <span class="m">0.013</span>
 <span class="p">[</span><span class="m">6</span><span class="p">,]</span> <span class="m">0.001</span> <span class="m">0.016</span>
 <span class="p">[</span><span class="m">7</span><span class="p">,]</span> <span class="m">0.002</span> <span class="m">0.019</span>
 <span class="p">[</span><span class="m">8</span><span class="p">,]</span> <span class="m">0.002</span> <span class="m">0.023</span>
 <span class="p">[</span><span class="m">9</span><span class="p">,]</span> <span class="m">0.002</span> <span class="m">0.026</span>
<span class="p">[</span><span class="m">10</span><span class="p">,]</span> <span class="m">0.002</span> <span class="m">0.029</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-r" data-lang="r"> <span class="n">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>
 <span class="n">library</span><span class="p">(</span><span class="n">SciencesPo</span><span class="p">)</span> <span class="c1"># for using theme_538
</span><span class="n">ggplot</span><span class="p">()</span> <span class="o">+</span> 
<span class="n">geom_line</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">prob</span><span class="p">,</span> <span class="n">p</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="m">1</span><span class="p">)</span> <span class="o">+</span>
    <span class="n">theme_538</span><span class="p">()</span>

 </code></pre></figure>

<p>I’m not in the field of epidemiology or biostatistics, but this simple experiment teaches two things. First, it is really important to keep the incidence rate low. Assuming we randomly selected you for the test, when <em>p</em> is really small, it’s much more likely that you got a false positive (you are positive when you are in fact negative). But as <em>p</em> gets larger, it becomes more likely that you do have the infection and the test result is accurate. Second, the accuracy of the test “improves” as a by-product of the incidence/prevalence among elements within the population.</p>


                <hr>

                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/blog/2016/star-wars-grossing-war.html" data-toggle="tooltip" data-placement="top" title="The Star Wars Grossing War">&larr; Previous Post</a>
                    </li>
                    
                    
                </ul>
		  	  

            </div>
        </div>
    </div>
</article>

<hr>


    


    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    <li>
                        <a href="/feed.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="https://twitter.com/dmarcelinobr">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    
                    <li>
                        <a href="https://github.com/danielmarcelino">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
		            

		            
                    
                    <li>
                        <a href="mailto:dmarcelino@live.com">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                </ul>
                <p class="syndicated text-center footer-links">
                 Some contents of this blog are contributed to <a  href="http://www.statsblogs.com">Statsblogs</a> and 
<a href="http://www.r-bloggers.com">R-Bloggers</a>, the largest blog aggregator for R related content. 
<br/>
</p>
        <p class="copyright text-muted">
          &copy; Daniel Marcelino
          &nbsp;&bull;&nbsp;
          2016 
&nbsp;&bull;&nbsp;
<a href="http://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">(CC) BY-NC-SA</a>
        </p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/clean-blog.min.js "></script>


</body>

</html>
